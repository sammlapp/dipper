name: dipper_pytorch_env1
channels:
  - pytorch
  - conda-forge
  - defaults

dependencies:
  - python=3.11
  - pip

  # Core ML libraries
  - pytorch==2.7.1 # avoids pip install opso later changing version
  - torchvision>=0.9.0
  - torchaudio>=0.9.0
  - pandas>=1.3.0
  - scikit-learn>=1.0.0

  # Additional ML dependencies
  - scipy>=1.7.0
  - matplotlib>=3.5.0
  - seaborn>=0.11.0
  - h5py>=3.0.0
  - pydantic>=1.8.0
  - timm>=1.0.0
  - transformers==4.53.2 #was >=4.53.2, but ConvNextForImageClassification not in later versions
  - lightning>=2.0.0


  # Audio processing 
  - librosa

  # System utilities
  - psutil>=5.8.0
  - tqdm>=4.60.0
  - pyyaml>=6.0
  - scikit-learn==1.7.0  # avoids pip later changing version
  - numpy==2.2.6  # avoids pip later changing version
  - sympy==1.14.0  # avoids pip later changing version
  - tinycss2==1.4.0  # avoids pip later changing veresion
  - cryptography==43.0.3 # pin for version compatible with older linux distros

  # Jupyter and development
  - jupyter
  - ipython
  - notebook
  
  # HTTP and networking
  - aiohttp>=3.8.0
  - aiohttp-cors>=0.7.0
  
  - pip:
    # Audio processing packages
    - soundfile>=0.10.0

    # Machine learning and data processing
    #litert #1.4.0 has a bug on Mac OSX
    - ai-edge-litert>=1.3.0, <1.4.0
    - tensorflow>=2.20.0
    - tensorflow-hub

    # Bioacoustics libraries (with latest development code)
    - git+https://github.com/kitzeslab/opensoundscape.git@dev.20251120
    - git+https://github.com/kitzeslab/bioacoustics-model-zoo.git@main
    # Avoid package mismatches between pip/conda
    # they don't actually have to be this exact version, just have to match
    - torch==2.7.1  
    - numpy==2.2.6 
    - sympy==1.14.0

# had to "pip install --force-reinstall protobuf" to fix protobuf import error 
# also had to "pip uninstall flatbuffers", "pip install flatbuffers" to fix flatbuffers import error
# but these weren't necessary for a fresh conda env create -f dipper_pytorch_env_linux.yml
# now it works for everything: Perch2 (TF), HawkEars (pytorch/timm), BirdNET (TFLite), and BirdSET (pytorch/huggingface-transformers) models!